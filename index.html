<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>PORTAL CONECTIVIDAD TTC</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />

  <!-- Fuente moderna -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- FontAwesome (íconos) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Tus estilos -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <header class="hero">
    <div class="hero__overlay"></div>
    <div class="hero__content container">
      <div class="brand">
        <i class="fa-solid fa-network-wired"></i>
        <span>PORTAL CONECTIVIDAD TTC</span>
      </div>
      <div class="date" id="currentDate"></div>
    </div>
  </header>

  <main class="container">
    <!-- Tarjeta de carga y acciones -->
    <section class="card">
      <div class="card__header">
        <h2><i class="fa-solid fa-database"></i> Procesamiento de Archivos</h2>
        <!-- Botón limpiar (mantiene id y onclick indirecto) -->
        <button type="button" class="icon-btn danger" id="btnClear" onclick="clearAll()" title="Limpiar todo">
          <i class="fas fa-trash"></i>
        </button>
      </div>

      
      <form id="uploadForm" class="form-grid">
        <!-- 1) Cargar Base -->
        <div class="form-row">
          <label for="fileBase" class="form-label">Archivo Base</label>
          <div class="input-actions">
            <input type="file" id="fileBase" accept=".xlsx" class="input-file" />
            <button type="button" class="btn cargarBase" onclick="cargarArchivoBase()">
              <i class="fa-solid fa-upload"></i> Cargar Base
            </button>
          </div>
          <p class="hint">Carga el archivo previamente trabajado (formato .xlsx)</p>
        </div>

        <!-- 2) Analizar Nuevo -->
        <div class="form-row">
          <label for="fileNuevo" class="form-label">Archivo Nuevo</label>
          <div class="input-actions">
            <input type="file" id="fileNuevo" accept=".xlsx" class="input-file" />
            <button type="button" class="btn analizar" onclick="analizarArchivoNuevo()">
              <i class="fa-solid fa-magnifying-glass-chart"></i> Analizar Nuevo
            </button>
          </div>
          <p class="hint">Analiza registros &gt; 7 días y fusiona con la Base</p>
        </div>
      </form>

    
      <div class="summary">
        <h4 id="unidadesSinComunicar" class="badge badge-info" style="display:none;"></h4>
      </div>

      <!-- Grupo de iconos para exportar/enviar (mismo id) -->
      <div id="iconButtons" class="actions" style="display:none;">
        <button type="button" class="icon-btn" onclick="exportToExcel()" title="Exportar a Excel">
          <i class="fas fa-file-excel"></i>
        </button>
        <button type="button" class="icon-btn" onclick="exportToPDF()" title="Exportar a PDF">
          <i class="fas fa-file-pdf"></i>
        </button>
        <button type="button" class="icon-btn" onclick="sendByEmail()" title="Enviar por correo">
          <i class="fas fa-envelope"></i>
        </button>
      </div>
    </section>

    <section class="card">
      <div class="card__header">
        <h2><i class="fa-solid fa-table"></i> Resultados</h2>
      </div>

      <div class="table-wrapper">
        <table id="resultsTable" class="table">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>SD</th>
              <th>Tipo de dispositivo</th>
              <th>UID</th>
              <th>Teléfono</th>
              <th>Hora de último mensaje</th>
              <th>Creada</th>
              <th>Grupos</th>
              <th>Campos personalizados</th>
              <th>Días Sin Comunicación</th>
            </tr>
          </thead>
          <tbody>
     
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__content">
      <span>© <span id="yearCopy"></span> TTC · Conectividad</span>
      <span class="footer__right">Status: <span class="dot"></span> listo</span>
    </div>
  </footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.14/jspdf.plugin.autotable.min.js"></script>


  <script src="script.js"></script>

  
  <script>
    document.getElementById('yearCopy').textContent = new Date().getFullYear();
  </script>
</body>
</html>
